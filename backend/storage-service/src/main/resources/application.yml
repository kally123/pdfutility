server:
  port: 8083

spring:
  application:
    name: storage-service

  # R2DBC PostgreSQL Configuration
  r2dbc:
    url: r2dbc:postgresql://localhost:5432/pdfutility_storage
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:postgres}
    pool:
      initial-size: 5
      max-size: 20

  # WebFlux Configuration
  webflux:
    multipart:
      max-in-memory-size: 10MB
      max-disk-usage-per-part: 100MB
      max-parts: 20

# Storage Configuration
storage:
  provider: ${STORAGE_PROVIDER:local} # local, azure, s3
  
  local:
    base-path: ${LOCAL_STORAGE_PATH:./uploads}
    temp-path: ${LOCAL_TEMP_PATH:./temp}
  
  azure:
    connection-string: ${AZURE_STORAGE_CONNECTION_STRING:}
    container-name: ${AZURE_CONTAINER_NAME:pdfutility}
    temp-container-name: ${AZURE_TEMP_CONTAINER_NAME:pdfutility-temp}
  
  s3:
    endpoint: ${S3_ENDPOINT:http://localhost:9000}
    access-key: ${S3_ACCESS_KEY:minioadmin}
    secret-key: ${S3_SECRET_KEY:minioadmin}
    bucket-name: ${S3_BUCKET_NAME:pdfutility}
    temp-bucket-name: ${S3_TEMP_BUCKET_NAME:pdfutility-temp}
    region: ${S3_REGION:us-east-1}

  # File settings
  max-file-size: 100MB
  allowed-extensions:
    - pdf
    - png
    - jpg
    - jpeg
  temp-file-expiration: 24h # Temporary files expire after 24 hours

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when_authorized

# Logging
logging:
  level:
    com.pdfutility: DEBUG

# OpenAPI Configuration
springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html
